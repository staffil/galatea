{% load static %} 
{% load i18n %}

<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE }}">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% trans "GALATEA - Chat with Celebrities" %}</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700;900&family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="{% static 'css/home/voice_all.css' %}">
    <script src="{% static 'js/home/main.js' %}"></script>
        <!-- Open Graph (SNS ê³µìœ ìš©) -->
    <meta property="og:title" content="GALATEA AI - ìŒì„± ëŒ€í™”í˜• ì±—ë´‡" />
    <meta property="og:description" content="ìì—°ìŠ¤ëŸ¬ìš´ ìŒì„± ëŒ€í™”í˜• AI ì±—ë´‡. ê³ ê°ê³¼ ì‚¬ëŒì²˜ëŸ¼ ëŒ€í™”í•˜ë©° ìƒë‹´ê³¼ ì•ˆë‚´ë¥¼ ì œê³µí•©ë‹ˆë‹¤." />
    <meta property="og:image" content="https://galatea.website/static/img/intro2.png">
    <meta property="og:url" content="https://galatea.website" />
    <meta property="og:type" content="website" />

    <!-- Meta Description (ê²€ìƒ‰ ê²°ê³¼ìš©) -->
    <meta name="description" content="ë¬¸ìë§Œ ì…ë ¥í•˜ëŠ” ì±—ë´‡ì€ ì´ì œ ê·¸ë§Œ! GALATEA AIëŠ” ìŒì„± ê¸°ë°˜ ëŒ€í™”í˜• AIë¡œ, ì‹¤ì œ ì‚¬ëŒì²˜ëŸ¼ ëŒ€í™” ê²½í—˜ì„ ì œê³µí•©ë‹ˆë‹¤. GALATEA AIëŠ” ë‹¨ìˆœí•œ ì±—ë´‡ì´ ì•„ë‹™ë‹ˆë‹¤. ìŒì„±ìœ¼ë¡œ ì‚¬ëŒì²˜ëŸ¼ ëŒ€í™”í•˜ë©°, ìì—°ìŠ¤ëŸ¬ìš´ ìƒë‹´Â·ì•ˆë‚´ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì§€ê¸ˆ ë¬´ë£Œ ì²´í—˜ìœ¼ë¡œ ì§ì ‘ ê²½í—˜í•´ë³´ì„¸ìš”. ">

    <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "GALATEA AI",
  "url": "https://www.galatea.website",
  "logo": "https://www.galatea.website/static/img/logo.png"
}
</script>

</head>

<style>
.refresh-btn {
    padding: 10px 20px;
    background-color: #4CAF50;
    color: white;
    font-weight: bold;
    border: none;
    border-radius: 8px;
    cursor: pointer;
}
.refresh-btn:hover {
    background-color: #45a049;
}
</style>

<body>
    <!-- í—¤ë” -->
    <header>
        {% if not user.is_authenticated %}
            {% include "common/notLoginHeader.html" %}
        {% else %}
            {% include "common/loginHeader.html" %}
        {% endif %}
    </header>
    <!-- celebrity voice ëª©ë¡ -->
    <div class="cv-main-content">
        <h2 class="cv-section-title">{% trans 'ì´ê±° í•œë²ˆ ì‚¬ìš©í•´ ë³´ì„¸ìš”!' %}</h2>
        <p>{% trans 'ğŸ¶ê°€ ìˆëŠ” ëª©ì†Œë¦¬ëŠ” ë…¸ë˜ê°€ ê°€ëŠ¥í™ë‹ˆë‹¤.' %}</p>
        
        <div class="cv-container">
            <div class="cv-scroll">
                {% for voice in voice_list|slice:":20" %}
                <div class="voice-wrapper">
                    <div class="cv-header">
                        <div class="voice-character" onclick="toggleAudio(this)" data-voice-id="{{ voice.id }}">
                            {% if voice.celebrity_voice_image %}
                                <img src="{{ voice.celebrity_voice_image.url }}" alt="" loading="lazy">
                            {% else %}
                                <img src="{% static 'images/default_voice.png' %}" alt="" loading="lazy">
                            {% endif %}
                            <div class="cv-play-overlay"><div class="cv-play-icon"></div></div>
                        </div>
                        <div class="cv-info">
                            <p>{{ voice.name }}</p>
                            <input type="hidden" value="{{ voice.celebrity_voice_id }}">
                            <p>{{ voice.voice_name }}</p>
                        </div>
                    </div>
                    <div class="voice-progress" onclick="seekAudio(event, this)">
                        <div class="cv-progress-bar"></div>
                    </div>
                    <button class="copy-id-btn" onclick="saveVoice({{ voice.id }})" title="Voice ID ì €ì¥">
                        {% trans 'ì €ì¥í•˜ê¸°' %}
                    </button>

                    {% if voice.sample_url %}
                    <audio class="voice-audio" controls>
                        <source src="{{ voice.sample_url.url }}" type="audio/mpeg">
                    </audio>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            <div style="text-align:center; margin: 20px 0;">
    <button onclick="refreshPage()" class="refresh-btn">{% trans 'ìƒˆë¡œê³ ì¹¨' %}</button>
</div>
        </div>


    </div>

    <script>
       function refreshPage() {
        window.location.reload();  // í˜„ì¬ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨
    }
    function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            // ì¿ í‚¤ ì´ë¦„ í™•ì¸
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

        // ëª©ì†Œë¦¬ ì €ì¥í•˜ê¸°
function saveVoice(celebrityId){
    fetch("{% url 'home:save_voice' %}", {
        method: "POST",
        headers: {
            "Content-Type": "application/json",
            "X-CSRFToken": getCookie('csrftoken') // CSRF ì²˜ë¦¬
        },
        body: JSON.stringify({ "celebrity_id": celebrityId })
    })
    .then(res => res.json())
    .then(data=>{
        if (data.status === "ok") {
            alert("ë³´ì´ìŠ¤ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
        } else {
            alert(data.error);
        }
    })
    .catch(error => console.error("Error:", error));
}

    </script>
</body>
</html>