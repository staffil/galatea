{% load static %} 
{% load i18n %}
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{% trans '마이페이지' %} - GALATEA</title>

    <link rel="stylesheet" href="{% static 'css/distribute/distribute.css' %}" />
    <link rel="stylesheet" href="{% static 'css/sidebar.css' %}" />
</head>

<body>

<!-- 배경 원형 효과 -->
<div class="circle-bg circle-1"></div>
<div class="circle-bg circle-2"></div>
<div class="circle-bg circle-3"></div>
<div class="circle-bg circle-4"></div>
<div class="circle-bg circle-5"></div>

<!-- 햄버거 메뉴 버튼 -->
<button class="menu-toggle" onclick="toggleSidebar()">
    <span></span><span></span><span></span>
</button>

<!-- 사이드바 오버레이 (모바일용) -->
<div class="sidebar-overlay" onclick="closeSidebar()"></div>

{% include "common/sidebar.html" %}

<div class="main-content">
    <div class="ai-config-container">

        <!-- **단일 LLM 수정/공유 폼** -->
        <form method="POST" action="{% url 'distribute:distribute' llm.id %}" enctype="multipart/form-data">
            {% csrf_token %}

            <!-- AI 이미지 섹션 -->
            <div class="form-group">
                <label>{% trans 'AI 이미지' %}</label>
                <div class="sidebar-profile">
                    {% if llm.llm_image %}
                        <img src="{{ llm.llm_image.url }}" alt="AI 이미지" style="width: 100%; height: 100%; object-fit: cover; border-radius: 15px;" />
                    {% else %}
                        <p style="color: white;">{% trans '생성된 이미지가 없습니다.' %}</p>
                    {% endif %}
                </div>
            </div>

            <!-- 제목 섹션 -->
            <div class="prompt-section">
                <label>{% trans '제목' %}</label>
                <input name="title" class="prompt-textarea" id="titleDisplay" style="height: 50px; margin-bottom: 10px;" value="{{ llm.title }}" placeholder="제목은 50자 이내입니다.">
            </div>

            <div class="distribute-grid">

                <!-- 프롬프트 섹션 -->
                <div class="prompt-section">
                    <label style="margin-bottom: 20px;">{% trans '프롬프트' %}</label>
                    <textarea class="prompt-textarea" id="promptDisplay" readonly>{{ llm.prompt }}</textarea>
                </div>

                <!-- 설명 섹션 -->
                <div class="description-section">
                    <label style="color: black;">{% trans 'AI 모델에 대한 간단한 설명을 작성해주세요' %}</label>
                    <textarea name="distribute" id="distributeDisplay" class="description-textarea" placeholder="{% trans '이 AI는 어떤 특징을 가지고 있나요? 예: 친근하고 유머러스한 대화 상대, 전문적인 조언을 제공하는 컨설턴트 등...' %}">{{ llm.description }}</textarea>
                </div>
            </div>

            <!-- 장르 태그 선택 -->
             
            <div class="genre-tags-container">
                <p>{% trans '장르는 최대 5개까지 선택 가능합니다.' %}</p>
                {% for genre in genre_list %}
                    <div class="genre-tag">
                        <input 
                            type="checkbox" 
                            name="genre" 
                            value="{{ genre.id }}" 
                            id="genre_{{ genre.id }}"
                            {% if genre.id|stringformat:"s" in selected_genres %}checked{% endif %}
                        />
                        <label for="genre_{{ genre.id }}" class="genre-tag-label" style="background-color: {{ genre.color }};">
                            <span class="genre-tag-text">{{ genre.name }}</span>
                            <span class="genre-tag-check">✓</span>
                        </label>
                    </div>
                {% endfor %}
            </div>

            <!-- 액션 버튼 -->
            <div style="display: flex; gap: 10px; margin-top: 30px; justify-content: center;">
                {% if llm.is_public %}
                    <button type="submit" class="action-button share-button" onclick="return confirm('{% trans '해당 AI를 정말 공유하시겠습니까?' %}')">
                        {% trans '수정한 내용 공유하기' %}
                    </button>
                {% else %}
                    <button type="submit" class="action-button share-button" onclick="return confirm('{% trans '해당 AI를 정말 공유하시겠습니까?' %}')">
                        {% trans '다른 사람들과 공유하기' %}
                    </button>
                {% endif %}

                <a href="{% url 'mypage:my_ai_models' llm.id %}" class="action-button">{% trans '돌아가기' %}</a>
                {% if llm.is_public %}
                    <a href="{% url 'distribute:unpublic' llm.id %}" class="action-button" onclick="return confirm('{% trans '공유를 취소하시겠습니까?' %}')">{% trans '공유취소하기' %}</a>
                {% endif %}
            </div>

        </form>

    </div>
</div>
<script src="{% static 'js/sidebar.js' %}"></script>

<script src="{% static 'js/distribute/distribute.js' %}">
</script>
{% if messages %}
  <script>
    {% for message in messages %}
      alert("{{ message|escapejs }}");
    {% endfor %}
  </script>
{% endif %}

</body>
</html>