"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BottomSheetDragAnimation=BottomSheetDragAnimation;const jsx_runtime_1=require("react/jsx-runtime"),react_native_gesture_handler_1=require("@granite-js/native/react-native-gesture-handler"),tds_easings_1=require("@toss/tds-easings"),react_1=require("react"),react_native_1=require("react-native");function BottomSheetDragAnimation({children:f,onDraggedUp:i,onDraggedDown:u,onDraggedMiddle:o,onDragToClose:l,onDragFinished:c,unstable_disableDragging:p=!1,...m}){const t=(0,react_1.useRef)(new react_native_1.Animated.Value(1)).current,r=(0,react_1.useRef)(new react_native_1.Animated.Value(0)).current,n=(0,react_1.useRef)(new react_native_1.Animated.Value(0)).current,a=(0,react_1.useMemo)(()=>react_native_gesture_handler_1.Gesture.Pan().activateAfterLongPress(200).onUpdate(e=>{const h=Math.log(Math.abs(e.translationX)+10)*5,M=Math.log(15)*5,_=Math.sign(e.translationX)*Math.max(h-M,0),V=Math.log(Math.abs(e.translationY)+10)*15,Y=Math.log(15)*15,x=Math.sign(e.translationY)*Math.max(V-Y,0),d=tds_easings_1.bezier.linear,v=e.translationY<0?.1:.01;react_native_1.Animated.parallel([react_native_1.Animated.timing(r,{toValue:_,duration:v,easing:react_native_1.Easing.bezier(...d),useNativeDriver:!0}),react_native_1.Animated.timing(n,{toValue:x,duration:v,easing:react_native_1.Easing.bezier(...d),useNativeDriver:!0})]).start(),e.translationY<=-50?i?.():e.translationY>=10?u?.():o?.()}).onFinalize(e=>{react_native_1.Animated.parallel([react_native_1.Animated.spring(t,{toValue:1,...tds_easings_1.spring.rapid,useNativeDriver:!0}),react_native_1.Animated.spring(r,{toValue:0,...tds_easings_1.spring.quick,useNativeDriver:!0}),react_native_1.Animated.spring(n,{toValue:0,...tds_easings_1.spring.quick,useNativeDriver:!0})]).start(),e.translationY>=50&&l?.(),c?.()}),[c,l,u,o,i,t,r,n]),s=(0,react_1.useMemo)(()=>react_native_gesture_handler_1.Gesture.LongPress().onStart(()=>{react_native_1.Animated.spring(t,{toValue:.98,...tds_easings_1.spring.rapid,useNativeDriver:!0}).start()}).onEnd(()=>{react_native_1.Animated.spring(t,{toValue:1,...tds_easings_1.spring.rapid,useNativeDriver:!0}).start()}),[t]),A=(0,react_1.useMemo)(()=>(a.runOnJS(!0),s.runOnJS(!0),react_native_gesture_handler_1.Gesture.Simultaneous(a,s)),[a,s]),g=(0,jsx_runtime_1.jsx)(react_native_1.Animated.View,{...m,style:[{transform:[{translateX:r},{translateY:n},{scale:t}]},m.style],children:f});return p?g:(0,jsx_runtime_1.jsx)(react_native_gesture_handler_1.GestureDetector,{gesture:A,children:g})}
