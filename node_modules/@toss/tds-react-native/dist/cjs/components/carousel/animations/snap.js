"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.useSnapAnimation=useSnapAnimation;const react_native_gesture_handler_1=require("@granite-js/native/react-native-gesture-handler"),tds_easings_1=require("@toss/tds-easings"),react_1=require("react"),react_native_1=require("react-native");function useSnapAnimation(e){const r=(0,react_1.useRef)(new react_native_1.Animated.Value(e.padding)).current,t=(0,react_1.useRef)(!1),[n,c]=(0,react_1.useState)(0),u=(0,react_1.useRef)(e.padding),i=(0,react_1.useRef)(e.padding),f=(0,react_1.useMemo)(()=>{const d=react_native_gesture_handler_1.Gesture.Pan().onUpdate(s=>{t.current!==!0&&(i.current=u.current+s.translationX,r.setValue(i.current))}).onEnd(s=>{if(t.current===!0)return;const o=getSnapPositions(e),p=getEstimatedPosition({translateX:i.current,translationX:s.translationX,velocityX:s.velocityX},e),a=roundToSnapPosition(p,o);t.current=!0,react_native_1.Animated.spring(r,{toValue:a,useNativeDriver:!0,...tds_easings_1.spring.quick}).start(()=>{i.current=a,u.current=i.current,t.current=!1}),c(o.findIndex(g=>g===a))});return d.runOnJS(!0),d},[e,r]),m=(0,react_1.useMemo)(()=>[{translateX:r}],[r]);return{gesture:f,transforms:m,activeIndex:n}}const WINDOW_WIDTH=react_native_1.Dimensions.get("window").width;function getSnapPositions(e){"worklet";return Array(e.itemsCount).fill(void 0).map((r,t)=>{switch(t){case 0:return e.padding;case e.itemsCount-1:{const n=WINDOW_WIDTH-e.itemWidth-e.padding;return e.padding-(e.itemWidth+e.itemGap)*(e.itemsCount-1)+(n-e.padding)}default:{const n=(WINDOW_WIDTH-e.itemWidth)/2;return e.padding-(e.itemWidth+e.itemGap)*t+(n-e.padding)}}})}function roundToSnapPosition(e,r){"worklet";let t=r[0];for(const n of r)Math.abs(n-e)<Math.abs(t-e)&&(t=n);return t}function getEstimatedPosition({translateX:e,translationX:r,velocityX:t},n){"worklet";return Math.abs(t)<n.itemWidth/2||Math.abs(r)>=n.itemWidth/2?e:e+Math.sign(t)*n.itemWidth}
