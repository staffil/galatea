"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Slider=void 0;const jsx_runtime_1=require("react/jsx-runtime"),react_native_gesture_handler_1=require("@granite-js/native/react-native-gesture-handler"),tds_colors_1=require("@toss/tds-colors"),react_1=require("react"),react_native_1=require("react-native"),styles_js_1=require("./styles.js"),useA11yMode_js_1=require("./useA11yMode.js"),utils_js_1=require("./utils.js");exports.Slider=(0,react_1.forwardRef)(function({min:s=0,max:n=100,value:i=s+n/2,step:o=1,onChange:l,color:_=tds_colors_1.colors.blue400,style:j,...m},p){if(!Number.isInteger(o)||o<=0)throw new Error("step\uC740 \uC591\uC758 \uC815\uC218\uB9CC \uC0AC\uC6A9\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4");const[r,b]=(0,react_1.useState)({container:0,thumb:0}),a=(0,react_1.useRef)(new react_native_1.Animated.Value(0)).current,u=r.container!==0&&r.thumb!==0,V=e=>{const t=r.container,c=r.thumb,y=t-c;return e===void 0||t===0||c===0||e<=c/2?s:e>=t-c/2?n:(0,utils_js_1.getNearestSteppedValue)(s+(n-s)*((e-c/2)/y),s,n,o)},d=e=>{const t=r.container,c=r.thumb,y=t-c;return(e-s)/(n-s)*y},h=e=>{const t=V(e);l?.(t),a.setValue(d(t))},v=(0,react_1.useMemo)(()=>react_native_gesture_handler_1.Gesture.Pan().onUpdate(e=>{h(e.x)}).onStart(e=>{h(e.x)}),[u]);(0,react_1.useEffect)(()=>{u&&a.setValue(d(i))},[u]);const f=(0,useA11yMode_js_1.useScreenReaderMode)();(0,react_1.useEffect)(()=>{f&&a.setValue(d(i))},[f,i]);const w=e=>{switch(e.nativeEvent.actionName){case"increment":l?.((0,utils_js_1.clamp)(i+o,s,n));break;case"decrement":l?.((0,utils_js_1.clamp)(i-o,s,n));break;default:break}};return(0,jsx_runtime_1.jsx)(react_native_gesture_handler_1.GestureDetector,{gesture:v,children:(0,jsx_runtime_1.jsxs)(react_native_1.View,{ref:p,style:[styles_js_1.styles.slider,j],onLayout:e=>{const{width:t}=e.nativeEvent.layout;b({...r,container:t})},accessible:!0,accessibilityRole:"adjustable",accessibilityValue:{text:`${i}`},accessibilityActions:[{name:"increment"},{name:"decrement"}],accessibilityLiveRegion:"polite",onAccessibilityAction:w,...m,children:[(0,jsx_runtime_1.jsx)(react_native_1.View,{style:styles_js_1.styles.track,pointerEvents:"none",children:(0,jsx_runtime_1.jsx)(react_native_1.Animated.View,{style:[styles_js_1.styles.progress,{backgroundColor:_,transform:[{translateX:a}]}]})}),(0,jsx_runtime_1.jsx)(react_native_1.Animated.View,{onLayout:e=>{const{width:t}=e.nativeEvent.layout;b({...r,thumb:t})},style:[styles_js_1.styles.thumb,{opacity:u?1:0,transform:[{translateX:a}]}],pointerEvents:"none"})]})})});
